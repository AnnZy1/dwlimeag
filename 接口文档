苍穹外卖管理系统 - 完整 Web 管理端接口文档
文档基础规范（全局统一）
接口基准地址：http://localhost:8080/api（开发）/ https://prod-domain.com/api（生产）
认证方式：所有接口（除登录外）需在请求头携带 Authorization: Bearer {JWT Token}
统一响应格式：
json
{
  "code": 200,        // 200=成功；401=未登录/Token过期；403=无权限；400=参数错误；500=系统异常
  "msg": "操作成功",   // 提示文案（失败时返回具体原因）
  "data": {}          // 业务数据（分页统一为 {total: 总数, list: 列表}）
}
分页参数：所有列表接口默认支持 pageNum=1（页码）、pageSize=10（每页条数）
时间参数：时间范围查询格式为 yyyy-MM-dd HH:mm:ss（如 beginTime=2025-01-01 00:00:00）
数据范围：分店员工接口自动过滤 branch_id，仅返回本店数据；管理员无限制
一、登录认证模块
接口名称  接口 URL  请求方式  核心说明
员工登录  /admin/auth/login POST  用户名 + 密码登录，生成 JWT Token
员工退出  /admin/auth/logout  POST  前端清除 Token，后端无需处理
登录日志查询  /admin/log/loginList  GET 多条件分页查询登录日志
账号解锁  /admin/auth/unlock  POST  解锁被锁定的员工账号
1.1 员工登录
请求参数（JSON）：
参数名 类型  必填  示例  说明
username  String  是 admin 登录用户名（员工表 username）
password  String  是 123456  明文密码（后端 BCrypt 校验）
响应示例：
json
{
  "code": 200,
  "msg": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VySWQiOjEsInJvbGUiOiJhZG1pbiIsImJyYW5jaElkIjoxLCJleHAiOjE3MTgwMDAwMDJ9.xxx",
    "userInfo": {
      "id": 1,
      "username": "admin",
      "name": "系统管理员",
      "roleId": 1,
      "roleName": "管理员",
      "branchId": 1,
      "branchName": "总店",
      "permissions": ["dish:list", "order:updateStatus"] // 按钮权限列表
    }
  }
}
1.2 账号解锁
请求参数（JSON）：
参数名 类型  必填  示例  说明
employeeId  Long  是 2 员工 ID
响应示例：
json
{
  "code": 200,
  "msg": "账号解锁成功",
  "data": null
}
二、员工管理模块
接口名称  接口 URL  请求方式  核心说明
员工列表查询  /admin/employee/list  GET 多条件分页查询员工
新增员工  /admin/employee/save  POST  创建员工，分配角色 / 分店
修改员工  /admin/employee/update  PUT 修改员工信息 / 状态
密码重置  /admin/employee/resetPwd  POST  重置员工密码为默认值
批量操作  /admin/employee/batch POST  批量启用 / 锁定 / 删除员工
2.1 新增员工
请求参数（JSON）：
参数名 类型  必填  示例  说明
username  String  是 zhangsan  用户名（唯一）
name  String  是 张三  员工姓名
phone String  是 13800138000 手机号（唯一）
sex String  否 男 性别（男 / 女 / 未知）
idNumber  String  否 110101xxxx  身份证号（加密存储）
roleId  Long  是 2 角色 ID
branchId  Long  是 1 分店 ID
status  Int 否 1 状态（1 = 正常 0 = 锁定）
响应示例：
json
{
  "code": 200,
  "msg": "新增员工成功",
  "data": {
    "id": 3,
    "username": "zhangsan",
    "name": "张三"
  }
}
2.2 密码重置
请求参数（JSON）：
参数名 类型  必填  示例  说明
employeeId  Long  是 3 员工 ID
响应示例：
json
{
  "code": 200,
  "msg": "密码重置成功（默认密码：123456）",
  "data": null
}
2.3 批量操作
请求参数（JSON）：
参数名 类型  必填  示例  说明
ids List<Long>  是 [2,3,4] 员工 ID 列表
operation String  是 lock  操作类型（lock = 锁定 /unlock = 启用 /delete = 删除）
响应示例：
json
{
  "code": 200,
  "msg": "批量锁定3名员工成功",
  "data": null
}
三、权限管理模块
接口名称  接口 URL  请求方式  核心说明
角色列表查询  /admin/role/list  GET 分页查询角色
新增角色  /admin/role/save  POST  创建角色并分配权限
修改角色  /admin/role/update  PUT 修改角色信息 / 权限
删除角色  /admin/role/delete  DELETE  软删除角色
字典列表查询  /admin/dict/list  GET 按类型查询字典项
新增字典  /admin/dict/save  POST  创建字典项
3.1 新增角色
请求参数（JSON）：
参数名 类型  必填  示例  说明
name  String  是 后厨  角色名称（唯一）
description String  否 后厨操作权限  角色描述
status  Int 否 1 状态（1 = 启用 0 = 禁用）
permissionIds List<Long>  是 [1,2,3] 关联的权限 ID 列表
响应示例：
json
{
  "code": 200,
  "msg": "新增角色成功",
  "data": {
    "id": 3,
    "name": "后厨"
  }
}
3.2 字典列表查询
请求参数（URL）：
参数名 类型  必填  示例  说明
dictType  String  是 order_status  字典类型（如 dish_status）
响应示例：
json
{
  "code": 200,
  "msg": "查询成功",
  "data": [
    {
      "id": 1,
      "dictType": "order_status",
      "dictCode": 1,
      "dictLabel": "待付款",
      "sort": 0
    },
    {
      "id": 2,
      "dictType": "order_status",
      "dictCode": 2,
      "dictLabel": "待接单",
      "sort": 1
    }
  ]
}
四、分店管理模块
接口名称  接口 URL  请求方式  核心说明
分店列表查询  /admin/branch/list  GET 分页查询分店
新增分店  /admin/branch/save  POST  创建分店信息
修改分店  /admin/branch/update  PUT 修改分店信息 / 状态
删除分店  /admin/branch/delete  DELETE  软删除分店
4.1 新增分店
请求参数（JSON）：
参数名 类型  必填  示例  说明
name  String  是 朝阳分店  分店名称（唯一）
address String  是 朝阳区 XX 路 XX 号 详细地址
contactName String  是 李四  联系人
contactPhone  String  是 13900139000 联系人手机号
status  Int 否 1 状态（1 = 启用 0 = 禁用）
响应示例：
json
{
  "code": 200,
  "msg": "新增分店成功",
  "data": {
    "id": 2,
    "name": "朝阳分店"
  }
}
五、分类管理模块
接口名称  接口 URL  请求方式  核心说明
分类列表查询  /admin/category/list  GET 按类型 / 分店查询分类
新增分类  /admin/category/save  POST  创建菜品 / 套餐分类
修改分类  /admin/category/update  PUT 修改分类信息 / 排序
删除分类  /admin/category/delete  DELETE  软删除分类（无关联菜品 / 套餐）
批量操作  /admin/category/batch POST  批量启用 / 禁用分类
拖拽排序  /admin/category/sort  POST  更新分类排序值
5.1 新增分类
请求参数（JSON）：
参数名 类型  必填  示例  说明
name  String  是 热菜  分类名称（同类型 + 分店唯一）
type  Int 是 1 类型（1 = 菜品 2 = 套餐）
sort  Int 否 0 排序值（越小越靠前）
branchId  Long  是 1 分店 ID
status  Int 否 1 状态（1 = 启用 0 = 禁用）
响应示例：
json
{
  "code": 200,
  "msg": "新增分类成功",
  "data": {
    "id": 5,
    "name": "热菜",
    "type": 1
  }
}
5.2 拖拽排序
请求参数（JSON）：
参数名 类型  必填  示例  说明
sortList  List  是 [{"id":5,"sort":1},{"id":6,"sort":0}] 分类 ID + 新排序值
响应示例：
json
{
  "code": 200,
  "msg": "排序成功",
  "data": null
}
六、菜品管理模块
接口名称  接口 URL  请求方式  核心说明
菜品列表查询  /admin/dish/list  GET 按分类 / 状态 / 分店查询菜品
新增菜品  /admin/dish/save  POST  创建菜品 + 口味 + 规格
修改菜品  /admin/dish/update  PUT 修改菜品信息
删除菜品  /admin/dish/delete  DELETE  软删除菜品
口味管理  /admin/dish/flavor/save POST  保存菜品口味
图片上传  /admin/common/upload  POST  上传图片至 OSS
批量上下架 /admin/dish/batch POST  批量起售 / 停售菜品
导入导出  /admin/dish/import  POST  Excel 导入菜品
导入导出  /admin/dish/export  GET Excel 导出菜品
6.1 新增菜品
请求参数（JSON）：
参数名 类型  必填  示例  说明
name  String  是 鱼香肉丝  菜品名称（分店唯一）
categoryId  Long  是 5 分类 ID（菜品类型）
price Decimal 是 28.00 基础单价
specifications  String  否 {"large":38.00,"small":28.00} 规格 JSON
image String  否 https://oss.xxx.com/1.jpg OSS 图片地址
description String  否 经典川菜  菜品描述
status  Int 否 1 售卖状态（1 = 起售 0 = 停售）
branchId  Long  是 1 分店 ID
flavors List  否 [{"name":"辣度","value":"微辣，中辣"}] 口味列表
响应示例：
json
{
  "code": 200,
  "msg": "新增菜品成功",
  "data": {
    "id": 10,
    "name": "鱼香肉丝"
  }
}
6.2 图片上传
请求参数（FormData）：
参数名 类型  必填  说明
file  File  是 图片文件（jpg/png，≤5MB）
响应示例：
json
{
  "code": 200,
  "msg": "上传成功",
  "data": {
    "url": "https://oss.xxx.com/2025/01/15/123456.jpg"
  }
}
七、套餐管理模块
接口名称  接口 URL  请求方式  核心说明
套餐列表查询  /admin/setmeal/list GET 按分类 / 状态 / 分店查询套餐
新增套餐  /admin/setmeal/save POST  创建套餐 + 关联菜品
修改套餐  /admin/setmeal/update PUT 修改套餐信息
删除套餐  /admin/setmeal/delete DELETE  软删除套餐
批量上下架 /admin/setmeal/batch  POST  批量起售 / 停售套餐
导出套餐  /admin/setmeal/export GET Excel 导出套餐
7.1 新增套餐
请求参数（JSON）：
参数名 类型  必填  示例  说明
name  String  是 双人超值套餐  套餐名称（分店唯一）
categoryId  Long  是 8 分类 ID（套餐类型）
price Decimal 是 88.00 套餐总价（≥菜品总价）
image String  否 https://oss.xxx.com/2.jpg OSS 图片地址
description String  否 2 人份含 3 菜 1 汤 套餐描述
status  Int 否 1 售卖状态（1 = 起售 0 = 停售）
branchId  Long  是 1 分店 ID
setmealDishes List  是 [{"dishId":10,"copies":1,"price":28.00}]  关联菜品列表
响应示例：
json
{
  "code": 200,
  "msg": "新增套餐成功",
  "data": {
    "id": 3,
    "name": "双人超值套餐"
  }
}
八、订单管理模块
接口名称  接口 URL  请求方式  核心说明
订单列表查询  /admin/order/list GET 多条件分页查询订单
订单详情  /admin/order/detail GET 查询订单 + 商品明细
修改订单状态  /admin/order/updateStatus PUT 订单状态流转（接单 / 取消等）
取消 / 拒单 /admin/order/cancel POST  取消订单并填写原因
订单导出  /admin/order/export GET Excel 导出订单
订单日志查询  /admin/order/log  GET 查询订单状态变更日志
8.1 订单列表查询
请求参数（URL）：
参数名 类型  必填  示例  说明
number  String  否 20250115001 订单号（模糊）
consignee String  否 王五  收货人（模糊）
phone String  否 13700137000 手机号（模糊）
status  Int 否 2 订单状态（字典项）
beginTime String  否 2025-01-01 00:00:00 下单开始时间
endTime String  否 2025-01-15 23:59:59 下单结束时间
branchId  Long  否 1 分店 ID
响应示例：
json
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "total": 100,
    "list": [
      {
        "id": 50,
        "number": "20250115001",
        "status": 2,
        "statusLabel": "待接单",
        "consignee": "王五",
        "phone": "13700137000",
        "amount": 90.00,
        "orderTime": "2025-01-15 12:30:00",
        "branchName": "总店"
      }
    ]
  }
}
8.2 修改订单状态
请求参数（JSON）：
参数名 类型  必填  示例  说明
id  Long  是 50  订单 ID
status  Int 是 3 新状态（3 = 已接单）
remark  String  否 尽快配送  操作备注（可选）
响应示例：
json
{
  "code": 200,
  "msg": "订单状态更新为已接单",
  "data": null
}
九、数据统计模块
接口名称  接口 URL  请求方式  核心说明
营业数据统计  /admin/stat/business  GET 按时间范围统计营业额 / 订单数
销量排行  /admin/stat/salesTop  GET 菜品 / 套餐销量 TOP10
订单分析  /admin/stat/orderAnalysis GET 订单状态 / 支付方式分布
报表导出  /admin/stat/export  GET 导出营业统计报表
9.1 营业数据统计
请求参数（URL）：
参数名 类型  必填  示例  说明
type  String  是 today 时间类型（today/week/month/custom）
beginTime String  否 2025-01-01 00:00:00 自定义开始时间
endTime String  否 2025-01-15 23:59:59 自定义结束时间
branchId  Long  否 1 分店 ID（管理员可选）
响应示例：
json
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "totalAmount": 12500.00, // 总营业额
    "orderCount": 150,       // 订单总数
    "avgAmount": 83.33,      // 客单价
    "refundAmount": 500.00   // 退款金额
  }
}
9.2 销量排行
请求参数（URL）：
参数名 类型  必填  示例  说明
type  String  是 dish  类型（dish = 菜品 /setmeal = 套餐）
beginTime String  是 2025-01-01 00:00:00 开始时间
endTime String  是 2025-01-15 23:59:59 结束时间
branchId  Long  否 1 分店 ID
响应示例：
json
{
  "code": 200,
  "msg": "查询成功",
  "data": [
    {
      "name": "鱼香肉丝",
      "sales": 80,    // 销量
      "amount": 2240.00 // 销售额
    },
    {
      "name": "宫保鸡丁",
      "sales": 75,
      "amount": 2100.00
    }
  ]
}
总结
接口规范统一：所有接口遵循相同的请求 / 响应格式，认证方式为 JWT Token，分页参数、时间格式全局统一，降低联调成本。
覆盖全业务场景：9 大核心模块接口完整，包含 CRUD、批量操作、导入导出、数据统计等，满足管理端所有操作需求。
数据范围控制：分店员工接口自动过滤branch_id，仅操作本店数据；管理员无限制，符合多分店管理的业务逻辑。
业务约束内置：接口参数校验、状态联动（如菜品停售导致套餐停售）、权限拦截等逻辑在接口层落地，确保数据一致性。